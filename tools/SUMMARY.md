# 问题解决总结

## ✅ 已完成的修改

### 1. Prompt 调整（符合单本完整小说需求）

**修改内容：**
- ❌ 移除 "前情提要"（`prev_summary`）- 不符合单本小说
- ❌ 移除 "本章大纲/爽点"（`chapter_outline`）- 不符合单本小说
- ✅ 改为 "故事主题/爽点"（`theme`）- 适用于单本完整小说

**修改的文件：**
- `tools/step1_get_prompt.py` - Prompt 生成逻辑
- `tools/story_config.json` - 配置文件（示例已更新）

---

## 📊 词汇库分析结果

### 当前状态
- **词库位置**：`tools/ielts_source.json`
- **当前数量**：约 75 个单词
- **目标数量**：4000 个雅思核心词
- **查看方法**：
  ```bash
  cd tools
  cat ielts_source.json  # 查看完整列表
  ```

### 学习规划计算

**需求：**
- 总词汇量：4000 词
- 小说类型：4 类（重生、悬疑、言情、商战）
- 每类小说：50 篇
- 用户模式：可能只读一类小说

**计算：**
- 每类需要覆盖：4000 词
- 每类小说数量：50 篇
- **每篇需要词汇量：80 词**（4000 ÷ 50 = 80）

**推荐配置：**
- 新词：60 词/篇
- 复习词：20 词/篇
- 总词汇：80 词/篇
- 字数：1500 字/篇（保持不变）

**评估：**
- ✅ **80 词在 1500 字中可以自然融入**
- ✅ **词汇密度 5.33%**（平均每 18.8 字一个词）
- ✅ **保持 1500 字不会影响用户留存**
- ✅ **词汇密度适中，不会过于密集**

---

## 🔄 词库重复使用机制

### 问题
用户可能只读一类小说，需要确保每类小说都能覆盖全部 4000 词。

### 解决方案：按类型独立追踪

**当前设计问题：**
- 进度追踪文件是全局的（`progress_tracker.json`）
- 不同类型小说共享进度，导致无法重复使用词库

**推荐方案：按类型独立追踪**

修改 `curriculum_manager.py` 和 `step2_save_chapter.py`，使每类小说都有独立的进度文件：

```
progress_tracker_reborn.json   # 重生类型
progress_tracker_suspense.json # 悬疑类型
progress_tracker_romance.json  # 言情类型
progress_tracker_business.json # 商战类型
```

这样每类小说都从完整的 4000 词库重新开始，确保用户只读一类也能学完所有词。

---

## 📋 待实施的改进

### 优先级 1：立即修改

1. **更新词汇量配置**（`step1_get_prompt.py`）
   - 修改 `batch_size = 60`（新词）
   - 修改 `review_size = 20`（复习词）

2. **扩充词库**（`ielts_source.json`）
   - 从 75 词扩充到 4000 词
   - 需要找到雅思核心词库资源

### 优先级 2：重要改进

3. **按类型独立追踪**（`curriculum_manager.py` + `step2_save_chapter.py`）
   - 修改进度追踪逻辑，支持按类型使用不同进度文件
   - 确保每类小说都能从 4000 词库重新开始

---

## 📝 详细分析文档

完整的分析报告请查看：`tools/VOCAB_ANALYSIS.md`

